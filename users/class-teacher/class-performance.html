<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Class Performance - Class Teacher</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="../../assets/css/main.css" rel="stylesheet">
    <link href="../../assets/css/components/sidebar.css" rel="stylesheet">
    <link href="../../assets/css/users/class-teacher.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            <nav class="col-md-3 col-lg-2 d-md-block bg-light sidebar" style="z-index: 1000;">
                <div class="position-sticky pt-3 d-flex flex-column h-100">
                    <div class="text-center mb-4">
                        <img src="../../assets/images/logo.png" alt="School Logo" class="img-fluid mb-2" style="max-height: 60px;">
                        <h6 class="text-muted">Class Teacher</h6>
                        <small class="text-muted">Staff ID: CT1234</small>
                    </div>
                    
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="dashboard.html">
                                <i class="fas fa-tachometer-alt"></i> Dashboard
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="my-subjects.html">
                                <i class="fas fa-book"></i> My Subjects
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="student-management.html">
                                <i class="fas fa-users"></i> Student Management
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="grade-entry.html">
                                <i class="fas fa-edit"></i> Grade Entry
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="report-cards.html">
                                <i class="fas fa-file-alt"></i> Report Cards
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="class-performance.html">
                                <i class="fas fa-chart-line"></i> Class Performance
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="announcements.html">
                                <i class="fas fa-bullhorn"></i> Announcements
                            </a>
                        </li>
                    </ul>
                    
                    <div class="mt-auto p-3 text-center">
                        <button class="btn btn-sm btn-outline-light" onclick="logout()">
                            <i class="fas fa-sign-out-alt"></i> Logout
                        </button>
                    </div>
                </div>
            </nav>

            <!-- Main content -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4 main-content">
                <div class="header">
                    <div>
                        <h4>Class Performance Analytics</h4>
                        <span class="role-badge">Class Teacher</span>
                    </div>
                    <div>
                        <span id="current-user">John Doe</span>
                        <i class="fas fa-user-circle ms-2 text-primary"></i>
                    </div>
                </div>
                
                <!-- Performance Controls -->
                <div class="card mb-4">
                    <div class="card-header">
                        <h5>Performance Analysis Controls</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-3">
                                <label class="form-label">Class</label>
                                <select class="form-select" id="class-filter" onchange="updatePerformance()">
                                    <option value="s4-science-a">S.4 Science A</option>
                                    <option value="s4-science-b">S.4 Science B</option>
                                    <option value="s3-science">S.3 Science</option>
                                    <option value="s2-science">S.2 Science</option>
                                    <option value="s1-science">S.1 Science</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Term</label>
                                <select class="form-select" id="term-filter" onchange="updatePerformance()">
                                    <option value="term1">Term 1</option>
                                    <option value="term2" selected>Term 2</option>
                                    <option value="term3">Term 3</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Subject</label>
                                <select class="form-select" id="subject-filter" onchange="updatePerformance()">
                                    <option value="">All Subjects</option>
                                    <option value="mathematics">Mathematics</option>
                                    <option value="physics">Physics</option>
                                    <option value="chemistry">Chemistry</option>
                                    <option value="biology">Biology</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Actions</label>
                                <div class="d-flex gap-2">
                                    <button class="btn btn-info btn-sm" onclick="exportPerformance()">
                                        <i class="fas fa-download"></i> Export
                                    </button>
                                    <button class="btn btn-primary btn-sm" onclick="refreshData()">
                                        <i class="fas fa-sync"></i> Refresh
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Performance Summary -->
                <div class="card mb-4">
                    <div class="card-header">
                        <h5>Class Performance Summary</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-3">
                                <div class="card bg-primary text-white text-center">
                                    <div class="card-body">
                                        <h3>82.5%</h3>
                                        <p class="mb-0">Class Average</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card bg-success text-white text-center">
                                    <div class="card-body">
                                        <h3>28</h3>
                                        <p class="mb-0">Passed (A-C)</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card bg-warning text-white text-center">
                                <div class="card-body">
                                        <h3>5</h3>
                                        <p class="mb-0">Below Average (D-F)</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card bg-info text-white text-center">
                                    <div class="card-body">
                                        <h3>85%</h3>
                                        <p class="mb-0">Pass Rate</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Performance Charts -->
                <div class="row mb-4">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h5>Grade Distribution</h5>
                            </div>
                            <div class="card-body">
                                <canvas id="gradeChart" width="400" height="200"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h5>Subject Performance</h5>
                            </div>
                            <div class="card-body">
                                <canvas id="subjectChart" width="400" height="200"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Top and Bottom Performers -->
                <div class="row mb-4">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h5>Top Performers</h5>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-sm">
                                        <thead>
                                            <tr>
                                                <th>Rank</th>
                                                <th>Student</th>
                                                <th>Average</th>
                                                <th>Grade</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>1st</td>
                                                <td>John Doe</td>
                                                <td>92.5%</td>
                                                <td><span class="badge bg-success">A</span></td>
                                            </tr>
                                            <tr>
                                                <td>2nd</td>
                                                <td>Mary Smith</td>
                                                <td>89.2%</td>
                                                <td><span class="badge bg-success">A</span></td>
                                            </tr>
                                            <tr>
                                                <td>3rd</td>
                                                <td>Peter Johnson</td>
                                                <td>87.8%</td>
                                                <td><span class="badge bg-success">A</span></td>
                                            </tr>
                                            <tr>
                                                <td>4th</td>
                                                <td>Sarah Wilson</td>
                                                <td>85.3%</td>
                                                <td><span class="badge bg-success">A</span></td>
                                            </tr>
                                            <tr>
                                                <td>5th</td>
                                                <td>David Brown</td>
                                                <td>83.7%</td>
                                                <td><span class="badge bg-primary">B</span></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h5>Students Needing Attention</h5>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-sm">
                                        <thead>
                                            <tr>
                                                <th>Student</th>
                                                <th>Average</th>
                                                <th>Grade</th>
                                                <th>Action</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>Alice Green</td>
                                                <td>45.2%</td>
                                                <td><span class="badge bg-danger">E</span></td>
                                                <td><button class="btn btn-sm btn-warning">Support</button></td>
                                            </tr>
                                            <tr>
                                                <td>Bob White</td>
                                                <td>48.7%</td>
                                                <td><span class="badge bg-danger">E</span></td>
                                                <td><button class="btn btn-sm btn-warning">Support</button></td>
                                            </tr>
                                            <tr>
                                                <td>Carol Black</td>
                                                <td>52.1%</td>
                                                <td><span class="badge bg-warning">D</span></td>
                                                <td><button class="btn btn-sm btn-info">Monitor</button></td>
                                            </tr>
                                            <tr>
                                                <td>Dan Blue</td>
                                                <td>55.8%</td>
                                                <td><span class="badge bg-warning">D</span></td>
                                                <td><button class="btn btn-sm btn-info">Monitor</button></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Performance Trends -->
                <div class="card">
                    <div class="card-header">
                        <h5>Performance Trends</h5>
                    </div>
                    <div class="card-body">
                        <canvas id="trendChart" width="800" height="300"></canvas>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../../assets/js/main.js"></script>
    <script src="../../assets/js/users/class-teacher.js"></script>
    <script>
        // Class Performance Functionality
        let gradeChart, subjectChart, trendChart;
        
        function initializeClassPerformance() {
            createGradeChart();
            createSubjectChart();
            createTrendChart();
        }
        
        function createGradeChart() {
            const ctx = document.getElementById('gradeChart').getContext('2d');
            gradeChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['A (80-100%)', 'B (70-79%)', 'C (60-69%)', 'D (50-59%)', 'E (40-49%)', 'F (0-39%)'],
                    datasets: [{
                        data: [15, 12, 8, 5, 3, 2],
                        backgroundColor: [
                            '#28a745',
                            '#007bff',
                            '#17a2b8',
                            '#ffc107',
                            '#dc3545',
                            '#343a40'
                        ],
                        borderWidth: 2,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }
        
        function createSubjectChart() {
            const ctx = document.getElementById('subjectChart').getContext('2d');
            subjectChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Mathematics', 'Physics', 'Chemistry', 'Biology', 'English'],
                    datasets: [{
                        label: 'Average Score (%)',
                        data: [85.2, 78.9, 82.1, 88.7, 76.3],
                        backgroundColor: [
                            '#007bff',
                            '#28a745',
                            '#ffc107',
                            '#dc3545',
                            '#17a2b8'
                        ],
                        borderWidth: 1,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }
        
        function createTrendChart() {
            const ctx = document.getElementById('trendChart').getContext('2d');
            trendChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4', 'Week 5', 'Week 6', 'Week 7', 'Week 8'],
                    datasets: [{
                        label: 'Class Average',
                        data: [75, 78, 80, 82, 85, 83, 87, 89],
                        borderColor: '#007bff',
                        backgroundColor: 'rgba(0, 123, 255, 0.1)',
                        tension: 0.4,
                        fill: true
                    }, {
                        label: 'Top Performer',
                        data: [85, 88, 90, 92, 95, 93, 97, 99],
                        borderColor: '#28a745',
                        backgroundColor: 'rgba(40, 167, 69, 0.1)',
                        tension: 0.4,
                        fill: false
                    }, {
                        label: 'Bottom Performer',
                        data: [65, 68, 70, 72, 75, 73, 77, 79],
                        borderColor: '#dc3545',
                        backgroundColor: 'rgba(220, 53, 69, 0.1)',
                        tension: 0.4,
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top'
                        }
                    }
                }
            });
        }
        
        function updatePerformance() {
            const classFilter = document.getElementById('class-filter').value;
            const term = document.getElementById('term-filter').value;
            const subject = document.getElementById('subject-filter').value;
            
            // Update charts based on filters
            showNotification('Performance data updated!', 'info');
        }
        
        function exportPerformance() {
            alert('Export Performance feature:\n\nThis will download the performance analytics as a PDF or Excel file.');
        }
        
        function refreshData() {
            // Refresh all charts and data
            if (gradeChart) gradeChart.update();
            if (subjectChart) subjectChart.update();
            if (trendChart) trendChart.update();
            
            showNotification('Performance data refreshed!', 'success');
        }
        
        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                window.location.href = '../../index.html';
            }
        }
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            initializeClassPerformance();
        });
    </script>
</body>
</html>